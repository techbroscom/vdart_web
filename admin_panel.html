<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
}

.sidebar {
    height: 100vh;
    width: 250px;
    position: fixed;
    top: 0;
    left: 0;
    background-color: #333;
    padding-top: 20px;
    z-index: 1; /* Ensure sidebar is on top */
}

.sidebar a {
    padding: 10px 15px;
    text-decoration: none;
    font-size: 18px;
    color: white;
    display: block;
}

.sidebar a.active {
    background-color: #555;
}

.sidebar a:hover {
    background-color: #555;
}

.content {
    margin-left: 250px; /* Adjust content area to accommodate sidebar */
    padding: 20px;
}

@media screen and (max-width: 768px) {
    .sidebar {
        left: -250px;
    }

    .sidebar.show {
        left: 0;
    }

    .toggle-btn {
        display: block;
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 2;
        font-size: 20px;
        background-color: #333;
        color: white;
        border: none;
        cursor: pointer;
    }
}

    </style>
</head>

<body>
    <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>

    <div class="sidebar">
        <a href="#" class="active" onclick="showContent('search')">Search</a>
        <a href="#" onclick="showContent('employee')">Employee Data</a>
        <a href="#" onclick="showContent('store')">Store Data</a>
        <a href="#" onclick="showContent('admin')">Admin Data</a>
        <a href="#" onclick="showContent('credit')">Credit Coins</a>
        <a href="#" onclick="showContent('createUser')">Add New User</a>
        <a href="#" onclick="showContent('config')">Configuration</a>
    </div>
    <div class="content" id="content">
        <div id="search">
            <h2>Search</h2>
            <form id="searchForm">
                <input type="text" id="searchInput" placeholder="Enter user ID">
                <button type="submit"><i class="fas fa-search"></i> Search</button>
            </form>
            <div id="searchResult" style="display:none;">
                <h3>User Details</h3>
                <p id="userDetails"></p>
                <button onclick="updateUserDetails()">Update Details</button>
            </div>
        </div>

        <div id="employee" style="display:none;">
            <h2>Employee Data</h2>
            <p>This is the Profile content.</p>
        </div>
        <div id="store" style="display:none;">
            <h2>Store Data</h2>
            <p>This is the Settings content.</p>
        </div>
        <div id="admin" style="display:none;">
            <h2>Admin Data</h2>
            <p>This is the Settings content.</p>
        </div>

        <div id="credit" style="display:none;">
            <h2>Credit</h2>
            <p>This is the Logout content.</p>
        </div>

        <div id="config" style="display:none;">
            <h2>Configuration</h2>
            <p>Coins Limit: <span id="coinsLimit" contenteditable="true"></span></p>
            <h3>Locations</h3>
            <ul id="locationsList"></ul>
            <button onclick="addLocation()">Add Location</button>
            <h3>User Types</h3>
            <ul id="userTypesList"></ul>
            <button onclick="addUserType()">Add User Type</button>
        </div>

        <div id="createUser" style="display:none;">
            <h2>Create New User</h2>
            <form id="createUserForm">
                <label for="newUserId">User ID:</label>
                <input type="text" id="newUserId" name="newUserId" required><br>
                <label for="newUserName">User Name:</label>
                <input type="text" id="newUserName" name="newUserName" required><br>
                <label for="newUserBalance">Balance:</label>
                <input type="number" id="newUserBalance" name="newUserBalance" required><br>
                <label for="newUserLocation">Location:</label>
                <input type="text" id="newUserLocation" name="newUserLocation" required><br>
                <label for="newUserStatus">Status:</label>
                <input type="text" id="newUserStatus" name="newUserStatus" required><br>
                <button type="submit">Create User</button>
            </form>
        </div>
    </div>

    <!-- Firebase JavaScript SDK and Initialization code -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        function showContent(id) {
            var contentDivs = document.getElementsByClassName('content')[0].children;
            var sidebarLinks = document.getElementsByClassName('sidebar')[0].children;
            for (var i = 0; i < contentDivs.length; i++) {
                contentDivs[i].style.display = 'none';
                sidebarLinks[i].classList.remove('active');
            }
            document.getElementById(id).style.display = 'block';
            event.currentTarget.classList.add('active');

            if (id === 'employee') {
                showEmployeeData();
            } else if (id === 'store') {
                showStoreData();
            } else if (id === 'admin') {
                showAdminData();
            }
        }

        // Show the first content by default
        document.getElementById('search').style.display = 'block';


// Firebase configuration (replace with your own config)
const firebaseConfig = {
  apiKey: "AIzaSyCvcxuv1-MWBtHMIUkeqGH_gfyBWaNN7K0",
  authDomain: "vdarttest.firebaseapp.com",
  projectId: "vdarttest",
  storageBucket: "vdarttest.appspot.com",
  messagingSenderId: "157342186908",
  databaseURL: "https://vdarttest-default-rtdb.asia-southeast1.firebasedatabase.app",
  appId: "1:157342186908:web:ea6c53598d3e9d1cab9c59",
  measurementId: "G-NVXLVD13D1"
};
  
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

var database = firebase.database();

function searchUser(event) {
    event.preventDefault();
    var userId = document.getElementById('searchInput').value;
    var userDetailsRef = database.ref('userDetails/' + userId);
    userDetailsRef.once('value', function(snapshot) {
        var userDetails = snapshot.val();
        if (userDetails) {
            var message = userDetails.message ? userDetails.message : "No message";
            var orderStore = userDetails.orderStore ? userDetails.orderStore : "No order store";
            var pendingTransId = userDetails.pendingTransId ? userDetails.pendingTransId : "No pending transaction ID";

            var userDetailsHtml = `
                <p><strong>User ID:</strong> ${userDetails.id}</p>
                <p><strong>User Name:</strong> <input type="text" id="userNameInput" value="${userDetails.userName}"></p>
                <p><strong>User Type:</strong> ${userDetails.userType}</p>
                <p><strong>Balance:</strong> <input type="text" id="balanceInput" value="${userDetails.balance}"></p>
                <p><strong>Location:</strong> ${userDetails.location}</p>
                <p><strong>Status:</strong> ${userDetails.status}</p>
                <p><strong>Order Store:</strong> ${orderStore}</p>
                <p><strong>Message:</strong> ${message}</p>
                <p><strong>Pending Transaction ID:</strong> ${pendingTransId}</p>
            `;
            document.getElementById('userDetails').innerHTML = userDetailsHtml;
            document.getElementById('searchResult').style.display = 'block';
        } else {
            alert('User not found');
        }
    });
}



function updateUserDetails() {
    var userId = document.getElementById('searchInput').value;
    var userName = document.getElementById('userNameInput').value;
    var balance = document.getElementById('balanceInput').value;
    var newDetails = {
        userName: userName,
        balance: balance
        // Add other fields to update if needed
    };
    var userDetailsRef = database.ref('userDetails/' + userId);
    userDetailsRef.update(newDetails, function(error) {
        if (error) {
            alert('Failed to update user details');
        } else {
            alert('User details updated successfully');
        }
    });
}

function showEmployeeData() {
    var userDetailsRef = database.ref('userDetails');
    userDetailsRef.once('value', function(snapshot) {
        var userDetails = snapshot.val();
        var employeeTableHtml = '<h2>Employee Data</h2><div class="table-responsive"><table class="table">';
        employeeTableHtml += '<thead><tr><th>User ID</th><th>User Name</th><th>Balance</th><th>Location</th><th>Status</th></tr></thead>';
        employeeTableHtml += '<tbody>';
        for (var userId in userDetails) {
            if (userDetails[userId].userType === 'Employee') {
                employeeTableHtml += '<tr>';
                employeeTableHtml += '<td>' + userDetails[userId].id + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].userName + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].balance + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].location + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].status + '</td>';
                employeeTableHtml += '</tr>';
            }
        }
        employeeTableHtml += '</tbody></table></div>';
        document.getElementById('employee').innerHTML = employeeTableHtml;
    });
}

function showStoreData() {
    var userDetailsRef = database.ref('userDetails');
    userDetailsRef.once('value', function(snapshot) {
        var userDetails = snapshot.val();
        var employeeTableHtml = '<h2>Store Data</h2><div class="table-responsive"><table class="table">';
        employeeTableHtml += '<thead><tr><th>User ID</th><th>User Name</th><th>Balance</th><th>Location</th><th>Status</th></tr></thead>';
        employeeTableHtml += '<tbody>';
        for (var userId in userDetails) {
            if (userDetails[userId].userType === 'Store') {
                employeeTableHtml += '<tr>';
                employeeTableHtml += '<td>' + userDetails[userId].id + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].userName + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].balance + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].location + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].status + '</td>';
                employeeTableHtml += '</tr>';
            }
        }
        employeeTableHtml += '</tbody></table></div>';
        document.getElementById('store').innerHTML = employeeTableHtml;
    });
}

function showAdminData() {
    var userDetailsRef = database.ref('userDetails');
    userDetailsRef.once('value', function(snapshot) {
        var userDetails = snapshot.val();
        var employeeTableHtml = '<h2>Admin Data</h2><div class="table-responsive"><table class="table">';
        employeeTableHtml += '<thead><tr><th>User ID</th><th>User Name</th><th>Balance</th><th>Location</th><th>Status</th></tr></thead>';
        employeeTableHtml += '<tbody>';
        for (var userId in userDetails) {
            if (userDetails[userId].userType === 'Admin') {
                employeeTableHtml += '<tr>';
                employeeTableHtml += '<td>' + userDetails[userId].id + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].userName + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].balance + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].location + '</td>';
                employeeTableHtml += '<td>' + userDetails[userId].status + '</td>';
                employeeTableHtml += '</tr>';
            }
        }
        employeeTableHtml += '</tbody></table></div>';
        document.getElementById('admin').innerHTML = employeeTableHtml;
    });
}




function toggleSidebar() {
    var sidebar = document.querySelector('.sidebar');
    sidebar.classList.toggle('show');
}

document.getElementById('searchForm').addEventListener('submit', searchUser);

document.getElementById('createUserForm').addEventListener('submit', function(event) {
    event.preventDefault();
    var newUserId = document.getElementById('newUserId').value;
    var newUserName = document.getElementById('newUserName').value;
    var newUserBalance = document.getElementById('newUserBalance').value;
    var newUserLocation = document.getElementById('newUserLocation').value;
    var newUserStatus = document.getElementById('newUserStatus').value;

    var newUserDetails = {
        id: newUserId,
        userName: newUserName,
        balance: parseInt(newUserBalance),
        location: newUserLocation,
        status: newUserStatus,
        userType: 'Customer' // Assuming new users are customers
    };

    var newUserRef = database.ref('userDetails').child(newUserId);
    newUserRef.set(newUserDetails, function(error) {
        if (error) {
            alert('Failed to create user');
        } else {
            alert('User created successfully');
            document.getElementById('createUserForm').reset();
        }
    });
});

// Fetch the config data from Firebase
var configRef = database.ref('config');
configRef.once('value', function(snapshot) {
    var config = snapshot.val();
    coinsLimit = config.coinsLimit;
    locations = Object.values(config.locations);
    userTypes = Object.values(config.userType);
    document.getElementById('coinsLimit').innerHTML = coinsLimit;

    // Display locations
    var locationsList = document.getElementById('locationsList');
    locationsList.innerHTML = locations.map(location => `<li>${location}</li>`).join('');

    // Display user types
    var userTypesList = document.getElementById('userTypesList');
    userTypesList.innerHTML = userTypes.map(userType => `<li>${userType}</li>`).join('');
});

document.getElementById('coinsLimit').addEventListener('input', function() {
    var newCoinsLimit = document.getElementById('coinsLimit').textContent;
    database.ref('config/coinsLimit').set(newCoinsLimit);
});

function addLocation() {
    var newLocation = prompt('Enter new location:');
    if (newLocation) {
        database.ref('config/locations').push(newLocation);
    }
}

function addUserType() {
    var newUserType = prompt('Enter new user type:');
    if (newUserType) {
        database.ref('config/userType').push(newUserType);
    }
}


</script>
</body>

</html>
