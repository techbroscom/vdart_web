<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pending Transactions</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Custom CSS -->
    <style>
        /* Your CSS styles here */
    </style>
</head>
<body>

<nav class="navbar navbar-dark bg-primary center">
    <span class="navbar-brand mb-0 h1">VDart Cafe Wallets</span>
</nav>

<div class="container">
    <!-- Pending Transaction Details -->
    <div class="pending-transactions">
        <h3>Pending Transactions:</h3>
        <ul id="pendingTransactionsList"></ul>
    </div>
</div>

<!-- Firebase JavaScript SDK and Initialization code -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
    // Your Firebase configuration and initialization code here

    const firebaseConfig = {
    apiKey: "AIzaSyCvcxuv1-MWBtHMIUkeqGH_gfyBWaNN7K0",
    authDomain: "vdarttest.firebaseapp.com",
    projectId: "vdarttest",
    storageBucket: "vdarttest.appspot.com",
    messagingSenderId: "157342186908",
    databaseURL: "https://vdarttest-default-rtdb.asia-southeast1.firebasedatabase.app",
    appId: "1:157342186908:web:ea6c53598d3e9d1cab9c59",
    measurementId: "G-NVXLVD13D1"
  };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Reference to the Firebase database
      const db = firebase.database();

// Get the store user ID from localStorage or any other source
const storeDetails = JSON.parse(localStorage.getItem('userDetails')); // Assuming you store the store user ID in localStorage

const storeId = storeDetails.id;
// Reference to the pending transactions for the store user ID
const pendingTransactionsRef = db.ref('transactions').child(storeId);

// Fetch pending transactions for the store user ID
pendingTransactionsRef.once('value', snapshot => {
    const pendingTransactions = snapshot.val();
    if (pendingTransactions) {
        // Display pending transactions
        const pendingTransactionsList = document.getElementById('pendingTransactionsList');
        pendingTransactionsList.innerHTML = ''; // Clear previous list
        for (let transactionId in pendingTransactions) {
            const transaction = pendingTransactions[transactionId];
            // Display transaction details as needed
            const transactionItem = document.createElement('li');
            transactionItem.textContent = `Transaction ID: ${transactionId}, Total: ${transaction.tCoins}`;

            // Create a button to update transaction status
            const updateButton = document.createElement('button');
            updateButton.textContent = 'Delivered';
            updateButton.addEventListener('click', () => {
                // Update the transaction status to "Delivered" in the database
                db.ref('transactions').child(storeId).child(transactionId).update({
                    tStatus: 'Delivered'
                }).then(() => {
                    console.log('Transaction status updated to Delivered');
                    // Optionally, update the UI to reflect the updated status
                    transactionItem.textContent = `Transaction ID: ${transactionId}, Total: ${transaction.tCoins} (Status: Delivered)`;
                    // Remove the update button
                    updateButton.remove();
                }).catch(error => {
                    console.error('Error updating transaction status:', error);
                });
            });

            // Append the button to the list item
            transactionItem.appendChild(updateButton);

            // Append the list item to the pendingTransactionsList
            pendingTransactionsList.appendChild(transactionItem);
        }
    } else {
        console.log('No pending transactions found for the store user ID');
    }
});

</script>

</body>
</html>
